<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ciudades - Población y Área</title>
  <!-- Usamos Bootstrap (opcional) para estilo rápido -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"/>
</head>
<body class="bg-light">
  <div class="container my-4">
    <h1 class="mb-4">Lista de Ciudades</h1>
    
    <h2>Tabla de Población</h2>
    <div id="tablaPoblacion" class="table-responsive mb-5"></div>
    
    <h2>Tabla de Área</h2>
    <div id="tablaArea" class="table-responsive"></div>
  </div>

  <!-- Bootstrap JS (opcional) -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <script>
    // Función para cargar un archivo CSV, parsearlo y devolver un array de objetos
    async function loadCSV(url) {
      const response = await fetch(url);
      const text = await response.text();

      // Separamos por líneas
      const lines = text.trim().split('\n'); 
      // Primera línea: cabeceras
      const headers = lines[0].split(';'); // <-- Aquí cambiamos a split(';')
      // Resto de líneas: datos
      const data = lines.slice(1).map(line => {
        const values = line.split(';'); // <-- También aquí
        let obj = {};
        headers.forEach((header, i) => {
          obj[header] = values[i];
        });
        return obj;
      });

      return data;
    }

    // Función para crear tabla HTML a partir de un array de objetos
    function createTableHTML(data) {
      if(!data || data.length === 0) return '<p>No hay datos</p>';

      // Obtener cabeceras
      const headers = Object.keys(data[0]);
      let html = '<table class="table table-bordered table-striped">';
      // Encabezado
      html += '<thead class="thead-dark"><tr>';
      headers.forEach(h => { html += `<th>${h}</th>`; });
      html += '</tr></thead>';
      // Cuerpo
      html += '<tbody>';
      data.forEach(row => {
        html += '<tr>';
        headers.forEach(h => {
          html += `<td>${row[h] || ''}</td>`;
        });
        html += '</tr>';
      });
      html += '</tbody></table>';
      return html;
    }

    // Cargar y mostrar tablas
    (async () => {
      try {
        // Cargamos CSV de población
        const dataPoblacion = await loadCSV('poblacion.csv');
        const tablaPoblacionHTML = createTableHTML(dataPoblacion);
        document.getElementById('tablaPoblacion').innerHTML = tablaPoblacionHTML;

        // Cargamos CSV de área
        const dataArea = await loadCSV('area.csv');
        const tablaAreaHTML = createTableHTML(dataArea);
        document.getElementById('tablaArea').innerHTML = tablaAreaHTML;

      } catch(error) {
        console.error('Error al cargar CSV:', error);
      }
    })();
  </script>
</body>
</html>
